<!-- Hero Section -->
<section class="hero-section">
  <div class="container mx-auto px-4 py-16">
    <div class="text-center">
      <h1 class="hero-title">
        Cómo Nuestros Tratamientos Transforman la Vida de Nuestras Pacientes
      </h1>
      <p class="hero-subtitle">
        Descubre cómo nuestros tratamientos especializados resuelven los
        problemas más comunes de la piel
      </p>
      <p class="hero-highlight">Resultados reales desde la primera sesión</p>
    </div>
  </div>
</section>

<!-- Beneficios de Tratamientos Section -->
<section class="benefits-section">
  <div class="container mx-auto px-4 py-16">
    <div class="text-center mb-12">
      <h2 class="section-title">Soluciones a Problemas Reales de la Piel</h2>
      <p class="section-subtitle">
        Nuestras pacientes experimentan cambios transformadores desde la primera
        sesión
      </p>
    </div>

    <div class="benefits-grid">
      <div
        *ngFor="
          let beneficio of beneficiosTratamientos;
          trackBy: trackByBeneficio
        "
        class="benefit-card"
      >
        <div class="benefit-header">
          <div class="problem-section">
            <h3 class="problem-title">Problema:</h3>
            <p class="problem-text">{{ beneficio.problema }}</p>
          </div>
          <div class="solution-section">
            <h3 class="solution-title">Solución:</h3>
            <p class="solution-text">{{ beneficio.solucion }}</p>
          </div>
        </div>

        <div class="benefit-description">
          <p>{{ beneficio.descripcion }}</p>
        </div>

        <!-- Carrusel individual para cada beneficio -->
        <div class="benefit-carousel" *ngIf="beneficio.imagenes.length > 0">
          <div class="carousel-wrapper-small">
            <div
              *ngFor="
                let imagen of beneficio.imagenes;
                let i = index;
                trackBy: trackByImagen
              "
              class="carousel-item-small"
              [class.active]="i === getCurrentImageIndex(beneficio)"
            >
              <img
                [src]="imagen.src | assets"
                [alt]="imagen.alt"
                class="carousel-image-small"
                loading="lazy"
              />
              <div class="carousel-overlay-small">
                <div class="carousel-description-small">
                  <p>{{ imagen.descripcion }}</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Controles del carrusel individual -->
          <button
            *ngIf="beneficio.imagenes.length > 1"
            class="carousel-control-small prev"
            (click)="previousCardImage(beneficio)"
            type="button"
          >
            <ion-icon name="chevron-back-outline"></ion-icon>
          </button>
          <button
            *ngIf="beneficio.imagenes.length > 1"
            class="carousel-control-small next"
            (click)="nextCardImage(beneficio)"
            type="button"
          >
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </button>

          <!-- Indicadores del carrusel individual -->
          <div
            *ngIf="beneficio.imagenes.length > 1"
            class="carousel-indicators-small"
          >
            <button
              *ngFor="
                let imagen of beneficio.imagenes;
                let i = index;
                trackBy: trackByImagen
              "
              class="indicator-small"
              [class.active]="i === getCurrentImageIndex(beneficio)"
              (click)="setCardImageIndex(beneficio, i)"
              type="button"
            ></button>
          </div>
        </div>

        <div class="benefit-keywords">
          <div class="keywords-label">Palabras clave relacionadas:</div>
          <div class="keywords-tags">
            <span
              *ngFor="
                let keyword of beneficio.keywords;
                trackBy: trackByKeyword
              "
              class="keyword-tag"
            >
              {{ keyword }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Carrusel de Instagram Section -->
<section class="instagram-section">
  <div class="container mx-auto px-4 py-16">
    <div class="text-center mb-12">
      <h2 class="section-title">Testimonios Visuales de Nuestras Pacientes</h2>
      <p class="section-subtitle">
        Algunos de los resultados más impactantes de nuestro perfil de Instagram
      </p>
    </div>

    <!-- Carrusel de imágenes -->
    <div class="carousel-container">
      <div class="carousel-wrapper">
        <div
          *ngFor="
            let imagen of imagenesInstagram;
            let i = index;
            trackBy: trackByImagenInstagram
          "
          class="carousel-item"
          [class.active]="i === currentCarouselIndex"
          (click)="openModal(i)"
        >
          <img
            [src]="imagen.src | assets"
            [alt]="imagen.alt"
            class="carousel-image"
            loading="lazy"
          />
          <div class="carousel-overlay">
            <div class="carousel-description">
              <p>{{ imagen.descripcion }}</p>
              <div class="view-more-hint">
                <ion-icon name="expand-outline"></ion-icon>
                <span>Click para ver más</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Controles del carrusel -->
      <button
        class="carousel-control prev"
        (click)="
          currentCarouselIndex =
            currentCarouselIndex === 0
              ? imagenesInstagram.length - 1
              : currentCarouselIndex - 1
        "
        type="button"
      >
        <ion-icon name="chevron-back-outline"></ion-icon>
      </button>
      <button
        class="carousel-control next"
        (click)="
          currentCarouselIndex =
            (currentCarouselIndex + 1) % imagenesInstagram.length
        "
        type="button"
      >
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </button>

      <!-- Indicadores -->
      <div class="carousel-indicators">
        <button
          *ngFor="
            let imagen of imagenesInstagram;
            let i = index;
            trackBy: trackByImagenInstagram
          "
          class="indicator"
          [class.active]="i === currentCarouselIndex"
          (click)="currentCarouselIndex = i"
          type="button"
        ></button>
      </div>
    </div>

    <!-- Call to action para Instagram -->
    <div class="instagram-cta">
      <div class="instagram-info">
        <h3 class="instagram-title">¿Quieres ver más resultados?</h3>
        <p class="instagram-subtitle">
          Visita nuestro perfil de Instagram para ver todos los testimonios y
          transformaciones
        </p>
      </div>
      <div class="instagram-actions">
        <a
          [href]="contactInfo.instagram"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-instagram"
        >
          <ion-icon name="logo-instagram"></ion-icon>
          Ver en Instagram
        </a>
        <a
          [href]="contactInfo.whatsapp"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-agendar"
        >
          Agendar Cita
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Modal de pantalla completa -->
<div *ngIf="showModal" class="modal-overlay" (click)="onModalClick($event)">
  <div class="modal-content">
    <button class="modal-close" (click)="closeModal()" type="button">
      <ion-icon name="close-outline"></ion-icon>
    </button>

    <div class="modal-image-container">
      <img
        [src]="imagenesInstagram[currentImageIndex].src | assets"
        [alt]="imagenesInstagram[currentImageIndex].alt"
        class="modal-image"
      />
      <div class="modal-description">
        <p>{{ imagenesInstagram[currentImageIndex].descripcion }}</p>
      </div>
    </div>

    <div class="modal-controls">
      <button
        class="modal-control prev"
        (click)="previousImage()"
        type="button"
      >
        <ion-icon name="chevron-back-outline"></ion-icon>
      </button>
      <button class="modal-control next" (click)="nextImage()" type="button">
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </button>
    </div>

    <div class="modal-actions">
      <a
        [href]="contactInfo.instagram"
        target="_blank"
        rel="noopener noreferrer"
        class="btn-instagram-modal"
      >
        <ion-icon name="logo-instagram"></ion-icon>
        Ver en Instagram
      </a>
      <a
        [href]="contactInfo.whatsapp"
        target="_blank"
        rel="noopener noreferrer"
        class="btn-agendar-modal"
      >
        Agendar
      </a>
    </div>
  </div>
</div>

<!-- CTA Section -->
<section class="cta-section">
  <div class="container mx-auto px-4 py-16 text-center">
    <h2 class="cta-title">¿Lista para tu transformación?</h2>
    <p class="cta-subtitle">
      Agendar ahora y comienza tu camino hacia una piel radiante
    </p>
    <a
      [href]="contactInfo.whatsapp"
      target="_blank"
      rel="noopener noreferrer"
      class="btn-primary-custom py-4 px-10 rounded-full font-montserrat text-lg"
    >
      Agendar ahora
    </a>
  </div>
</section>
